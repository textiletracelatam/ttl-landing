---
import Layout from "../layouts/Layout.astro";
import { appConfig } from "../config";
import { getCollection, getEntry } from "astro:content";
import { readFileSync } from "node:fs";

const { heading: ctaHeading, description: ctaDescription, primaryText, primaryHref, primaryColor, ghostText, ghostHref, ghostColor } = (await getEntry("contactanosCta", "cta"))!.data;

const filledStyles = {
  primary: "bg-primary-600 hover:bg-primary-500 focus-visible:outline-primary-600",
  secondary: "bg-secondary-600 hover:bg-secondary-500 focus-visible:outline-secondary-600",
  neutral: "bg-neutral-800 hover:bg-neutral-700 focus-visible:outline-neutral-800 dark:bg-neutral-200 dark:hover:bg-neutral-300 dark:text-neutral-900",
} as const;

const ghostStyles = {
  primary: "text-primary-600 dark:text-primary-400",
  secondary: "text-secondary-600 dark:text-secondary-400",
  neutral: "text-neutral-900 dark:text-white",
} as const;

const socialsEntries = await getCollection("socials");
const socials = socialsEntries
  .sort((a, b) => a.data.order - b.data.order)
  .map((s) => ({
    name: s.data.name,
    href: s.data.href,
    svg: readFileSync(`public${s.data.icon}`, "utf-8"),
  }));
---

<Layout title="Contáctanos">
  <div class="bg-background">
    <!-- Hero -->
    <div class="px-6 pt-8 pb-16 lg:px-8">
      <div class="mx-auto max-w-2xl pt-12 text-center sm:pt-20">
        <h1 class="text-5xl font-semibold tracking-tight text-neutral-900 sm:text-7xl dark:text-white">Contáctanos</h1>
        <p class="mt-8 text-lg font-medium text-pretty text-neutral-500 sm:text-xl/8 dark:text-neutral-400">Queremos escucharte. Escríbenos y te responderemos lo antes posible.</p>
      </div>
    </div>

    <!-- Contact info + Form -->
    <div class="mx-auto max-w-7xl px-6 pb-24 sm:pb-32 lg:px-8">
      <div class="mx-auto max-w-5xl lg:grid lg:grid-cols-5 lg:gap-16">

        <!-- Left: Info -->
        <div class="lg:col-span-2">
          <div class="space-y-10">
            <!-- Email -->
            <div class="flex gap-x-4">
              <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-primary-50 dark:bg-primary-500/10">
                <svg class="size-5 text-primary-600 dark:text-primary-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
                </svg>
              </div>
              <div>
                <h3 class="text-sm font-semibold text-neutral-900 dark:text-white">Correo electrónico</h3>
                <a href={`mailto:${appConfig.email}`} class="mt-1 block text-sm text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300">{appConfig.email}</a>
              </div>
            </div>

            <!-- Location -->
            <div class="flex gap-x-4">
              <div class="flex size-10 shrink-0 items-center justify-center rounded-lg bg-primary-50 dark:bg-primary-500/10">
                <svg class="size-5 text-primary-600 dark:text-primary-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
                </svg>
              </div>
              <div>
                <h3 class="text-sm font-semibold text-neutral-900 dark:text-white">Ubicación</h3>
                <p class="mt-1 text-sm text-neutral-600 dark:text-neutral-400">{appConfig.location}</p>
              </div>
            </div>

            <!-- Socials -->
            <div>
              <h3 class="text-sm font-semibold text-neutral-900 dark:text-white">Síguenos</h3>
              <div class="mt-4 flex gap-4">
                {socials.map((item) => (
                  <a
                    href={item.href}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="group flex size-10 items-center justify-center rounded-full bg-neutral-100 transition-colors hover:bg-primary-50 dark:bg-neutral-800 dark:hover:bg-primary-500/10 [&>svg]:size-5 [&>svg]:text-neutral-600 [&>svg]:transition-colors [&>svg]:group-hover:text-primary-600 dark:[&>svg]:text-neutral-400 dark:[&>svg]:group-hover:text-primary-400"
                  >
                    <span class="sr-only">{item.name}</span>
                    <Fragment set:html={item.svg} />
                  </a>
                ))}
              </div>
            </div>
          </div>
        </div>

        <!-- Right: Form -->
        <div class="mt-16 lg:col-span-3 lg:mt-0">
          <div class="rounded-2xl border border-neutral-200 bg-white p-8 shadow-sm sm:p-10 dark:border-neutral-700 dark:bg-neutral-800/50">
            <h2 class="text-2xl font-semibold text-neutral-900 dark:text-white">Envíanos un mensaje</h2>
            <p class="mt-2 text-sm text-neutral-600 dark:text-neutral-400">Completa el formulario y nos pondremos en contacto contigo.</p>
            <form action="#" method="POST" class="mt-8 space-y-6">
              <div class="grid grid-cols-1 gap-x-6 gap-y-6 sm:grid-cols-2">
                <div>
                  <label for="nombre" class="block text-sm/6 font-semibold text-neutral-900 dark:text-white">Nombre</label>
                  <input
                    type="text"
                    id="nombre"
                    name="nombre"
                    autocomplete="given-name"
                    required
                    class="mt-2 block w-full rounded-md bg-white px-3.5 py-2 text-base text-neutral-900 outline-1 -outline-offset-1 outline-neutral-300 placeholder:text-neutral-400 focus:outline-2 focus:-outline-offset-2 focus:outline-primary-600 dark:bg-white/5 dark:text-white dark:outline-white/10 dark:placeholder:text-neutral-500 dark:focus:outline-primary-500"
                  />
                </div>
                <div>
                  <label for="apellido" class="block text-sm/6 font-semibold text-neutral-900 dark:text-white">Apellido</label>
                  <input
                    type="text"
                    id="apellido"
                    name="apellido"
                    autocomplete="family-name"
                    class="mt-2 block w-full rounded-md bg-white px-3.5 py-2 text-base text-neutral-900 outline-1 -outline-offset-1 outline-neutral-300 placeholder:text-neutral-400 focus:outline-2 focus:-outline-offset-2 focus:outline-primary-600 dark:bg-white/5 dark:text-white dark:outline-white/10 dark:placeholder:text-neutral-500 dark:focus:outline-primary-500"
                  />
                </div>
              </div>

              <div>
                <label for="email" class="block text-sm/6 font-semibold text-neutral-900 dark:text-white">Correo electrónico</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  autocomplete="email"
                  required
                  class="mt-2 block w-full rounded-md bg-white px-3.5 py-2 text-base text-neutral-900 outline-1 -outline-offset-1 outline-neutral-300 placeholder:text-neutral-400 focus:outline-2 focus:-outline-offset-2 focus:outline-primary-600 dark:bg-white/5 dark:text-white dark:outline-white/10 dark:placeholder:text-neutral-500 dark:focus:outline-primary-500"
                />
              </div>

              <div>
                <label for="empresa" class="block text-sm/6 font-semibold text-neutral-900 dark:text-white">Empresa</label>
                <input
                  type="text"
                  id="empresa"
                  name="empresa"
                  autocomplete="organization"
                  class="mt-2 block w-full rounded-md bg-white px-3.5 py-2 text-base text-neutral-900 outline-1 -outline-offset-1 outline-neutral-300 placeholder:text-neutral-400 focus:outline-2 focus:-outline-offset-2 focus:outline-primary-600 dark:bg-white/5 dark:text-white dark:outline-white/10 dark:placeholder:text-neutral-500 dark:focus:outline-primary-500"
                />
              </div>

              <div>
                <label for="mensaje" class="block text-sm/6 font-semibold text-neutral-900 dark:text-white">Mensaje</label>
                <textarea
                  id="mensaje"
                  name="mensaje"
                  rows={4}
                  required
                  class="mt-2 block w-full rounded-md bg-white px-3.5 py-2 text-base text-neutral-900 outline-1 -outline-offset-1 outline-neutral-300 placeholder:text-neutral-400 focus:outline-2 focus:-outline-offset-2 focus:outline-primary-600 dark:bg-white/5 dark:text-white dark:outline-white/10 dark:placeholder:text-neutral-500 dark:focus:outline-primary-500"
                ></textarea>
              </div>

              <div>
                <button
                  type="submit"
                  class="w-full rounded-md bg-primary-600 px-5 py-3 text-sm font-semibold text-white shadow-xs hover:bg-primary-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600 dark:bg-primary-500 dark:hover:bg-primary-400 dark:focus-visible:outline-primary-500"
                >
                  Enviar mensaje
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- CTA -->
    <div class="bg-white py-16 sm:py-20 dark:bg-neutral-900">
      <div class="mx-auto max-w-7xl px-6 lg:px-8">
        <div class="mx-auto max-w-2xl text-center">
          <h2 class="text-4xl font-semibold tracking-tight text-pretty text-neutral-900 sm:text-5xl dark:text-white">{ctaHeading}</h2>
          <p class="mx-auto mt-6 max-w-xl text-lg/8 text-neutral-600 dark:text-neutral-400">{ctaDescription}</p>
          <div class="mt-10 flex items-center justify-center gap-x-6">
            <a href={primaryHref} class:list={["rounded-md px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2", filledStyles[primaryColor]]}>{primaryText}</a>
            <a href={ghostHref} class:list={["text-sm/6 font-semibold", ghostStyles[ghostColor]]}>{ghostText} <span aria-hidden="true">&rarr;</span></a>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>
