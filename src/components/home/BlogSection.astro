---
import { getEntry, getCollection } from "astro:content";

interface Props {}

const { tagline, heading, description, linkText, linkHref, postCount } = (await getEntry("homeBlog", "blog"))!.data;

const posts = (await getCollection("blog"))
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, postCount);
---

<div class="bg-background py-16 sm:py-20">
  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    <div class="mx-auto max-w-2xl text-center">
      <p class="text-base/7 font-semibold text-primary-600 dark:text-primary-400">{tagline}</p>
      <h2 class="mt-2 text-4xl font-semibold tracking-tight text-balance text-neutral-900 sm:text-5xl dark:text-white">{heading}</h2>
      <p class="mt-2 text-lg/8 text-neutral-600 dark:text-neutral-300">{description}</p>
    </div>
    <div class="mt-16 -mx-6 px-6 lg:-mx-8 lg:px-8 overflow-x-auto">
      <div class="flex gap-x-8" style="min-width: max-content;">
        {posts.map((post) => (
          <article class="flex w-80 shrink-0 flex-col items-start justify-between">
            <div class="relative w-full">
              <img src={post.data.image} alt={post.data.title} class="aspect-video w-full rounded-2xl bg-neutral-100 object-cover dark:bg-neutral-800" />
              <div class="absolute inset-0 rounded-2xl inset-ring inset-ring-neutral-900/10 dark:inset-ring-white/10"></div>
            </div>
            <div class="flex w-full grow flex-col justify-between">
              <div class="mt-8 flex items-center gap-x-4 text-xs">
                <time datetime={post.data.date.toISOString()} class="text-neutral-500 dark:text-neutral-400">
                  {post.data.date.toLocaleDateString("es-ES", { year: "numeric", month: "long", day: "numeric" })}
                </time>
                <span class="relative z-10 rounded-full bg-primary-50 px-3 py-1.5 font-medium text-primary-700 dark:bg-primary-500/10 dark:text-primary-400">{post.data.category}</span>
              </div>
              <div class="group relative grow">
                <h3 class="mt-3 text-lg/6 font-semibold text-neutral-900 group-hover:text-neutral-600 dark:text-white dark:group-hover:text-neutral-300">
                  <a href={`/blog/${post.id}`}>
                    <span class="absolute inset-0"></span>
                    {post.data.title}
                  </a>
                </h3>
                <p class="mt-5 line-clamp-3 text-sm/6 text-neutral-600 dark:text-neutral-400">{post.data.description}</p>
              </div>
              <div class="relative mt-8 flex items-center gap-x-4 justify-self-end">
                <p class="text-sm font-semibold text-neutral-900 dark:text-white">{post.data.author}</p>
              </div>
            </div>
          </article>
        ))}
      </div>
    </div>
    <div class="mt-16 text-center">
      <a href={linkHref} class="text-sm/6 font-semibold text-primary-600 dark:text-primary-400">{linkText} <span aria-hidden="true">&rarr;</span></a>
    </div>
  </div>
</div>
